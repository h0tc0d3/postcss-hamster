"use strict";

exports.__esModule = true;

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

/**
 * @module Helper
 * 
 * @description Constants and Help functions.
 * 
 * @version 1.0
 * @author Grigory Vasilyev <postcss.hamster@gmail.com> https://github.com/h0tc0d3
 * @copyright Copyright (c) 2017, Grigory Vasilyev
 * @license Apache License, Version 2.0, http://www.apache.org/licenses/LICENSE-2.0 
 */

function dotPos(value) {
    var len = value.length;
    do {
        len--;
        if (value.charCodeAt(len) === 46) {
            return len;
        }
    } while (len >= 0);
    return -1;
}

/**
 * Fast Format Float Values.
 * @param {number} value - input value.
 */
function formatValue(value) {
    // . - 46 0 - 48
    value = value.toFixed(4);
    var pos = dotPos(value);
    if (pos > -1) {
        var len = value.length;
        var code = 0;
        do {
            len--;
            code = value.charCodeAt(len);
        } while (code === 48 && pos < len || code === 46 && pos === len);

        if (len + 1 === value.length) {
            return value;
        }

        var ret = new safeUint8Array(len + 1);
        for (var j = 0; j <= len; j++) {
            ret[j] = value.charCodeAt(j);
        }
        return String.fromCharCode.apply(null, ret);
    }
    return value;
}

/**
 * Format Number to Int.
 * @param {number} value - input value.
 */
function formatInt(value) {
    return value.toFixed(0);
}

/**
 * Unit List
 */
var UNIT = {
    PX: 1,
    EM: 2,
    REM: 3,
    VW: 4,
    VH: 5,
    PERCENT: 6,
    EX: 7,
    PT: 8,
    IN: 9
};

var unitName = ["", "px", "em", "rem", "vw", "vh", "%", "ex", "pt", "in"];

/**
 * Return Unit to value.
 * @param {string} value - input value.
 */
function getUnit(value) {
    var len = value.length;
    var code1 = value.charCodeAt(len - 1);
    var code2 = value.charCodeAt(len - 2);
    // p 80 112
    // x 88 120
    // t 84 116
    // e 69 101
    // m 77 109
    // r 82 114
    // v 86 118
    // w 87 119
    // h 72 104
    // i 73 105
    // n 78 110
    // % 37
    if (code1 === 37) {
        return UNIT.PERCENT;
    } else if (code2 === 80 || code2 === 112) {
        if (code1 === 88 || code1 === 120) {
            return UNIT.PX;
        } else if (code1 === 84 || code1 === 116) {
            return UNIT.PT;
        }
    } else if (code2 === 86 || code2 === 118) {
        if (code1 === 87 || code1 === 119) {
            return UNIT.VW;
        } else if (code1 === 72 || code1 === 104) {
            return UNIT.VH;
        }
    } else if ((code1 === 77 || code1 === 109) && (code2 === 69 || code2 === 101)) {
        var code3 = value.charCodeAt(len - 3);
        if (code3 === 82 || code3 === 114) {
            return UNIT.REM;
        }
        return UNIT.EM;
    } else if ((code1 === 78 || code1 === 110) && (code2 === 73 || code2 === 105)) {
        return UNIT.IN;
    }

    return 0;
}

/**
 * Regexp for rem value.
 */
var remRegexp = /([0-9.]+)rem/i;

/**
 * Check value contains string;
 * @param {string} value - input value.
 * @param string
 */

function isHas(value, string) {
    return value.toLowerCase().indexOf(string) > -1;
}

/**
 * Copy Values from object 2 to object 1.
 * @param object1 
 * @param object2
 * @param ret - return object1 true or false
 * @return object1
 */
function extend(object1, object2) {
    var ret = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;


    for (var key in object2) {
        if (object2.hasOwnProperty(key)) {
            object1[key] = object2[key];
        }
    }
    if (ret) {
        return object1;
    }
}

var safeUint8Array = scmpStr(typeof Uint8Array === "undefined" ? "undefined" : _typeof(Uint8Array), "undefined") ? Array : Uint8Array;

/**
 * To Camel Case string.
 * @param {string} value  - input string.
 */
function toCamelCase(value) {

    var len = value.length;
    var buffer = new safeUint8Array(len);

    // Code: 48-57 Chars: 0-9
    // Code: 65-90 Chars: A-Z 
    // Code: 97-122 Chars: a-z

    var prev = value.charCodeAt(0); // previous char
    var firstWas = false; //is first letter was
    var count = 0;
    for (var i = 0; i < len; i++) {

        var code = value.charCodeAt(i);

        // It's Number
        if (code > 47 && code < 58) {
            // Add Number
            buffer[count] = code;
            count++;
        } else if (code > 96 && code < 123) {
            // It's lower case letter

            //If previous char is't letter or number,
            if (firstWas && !(prev > 47 && prev < 58 || prev > 96 && prev < 123 || prev > 64 && prev < 91)) {
                code = code & 1 + 2 + 4 + 8 + 16 + 64 + 128; // toUpperCase
            }

            buffer[count] = code;
            count++;

            if (!firstWas) {
                firstWas = true;
            }
        } else if (code > 64 && code < 91) {
            // It's upper case letter

            // If previous char is letter or number,
            if (prev > 47 && prev < 58 || prev > 96 && prev < 123 || prev > 64 && prev < 91) {
                code = code | 32; // toLowerCase
            }

            buffer[count] = code;
            count++;

            if (!firstWas) {
                firstWas = true;
            }
        }

        prev = code;
    }
    var ret = new safeUint8Array(count);
    for (var j = 0; j < count; j++) {
        ret[j] = buffer[j];
    }
    return String.fromCharCode.apply(null, ret);
}

/**
 * To Kebab Case string.
 * @param {string} value  - input string.
 */
function toKebabCase(value) {
    var len = value.length;
    var count = 0;
    for (var i = 0; i < len; i++) {
        var code = value.charCodeAt(i);
        if (code >= 65 && code <= 90) {
            count++;
        }
    }
    var buffer = new safeUint8Array(len + count);
    var pos = 0;
    for (var _i = 0; _i < len; _i++) {
        var _code = value.charCodeAt(_i);
        if (_code >= 65 && _code <= 90) {
            buffer[pos] = 45;
            buffer[pos + 1] = _code | 32;
            pos += 2;
        } else {
            buffer[pos] = _code;
            pos++;
        }
    }
    return String.fromCharCode.apply(null, buffer);
}

/**
 * Check string contains number.
 * @param value - input string.
 */
function hasNumber(value) {
    var len = value.length;
    for (var i = 0; i < len; i++) {
        var code = value.charCodeAt(i);
        if (code >= 48 && code <= 57) {
            return true;
        }
    }
    return false;
}

/**
 * Compare input string with reference string.
 * @param str - input string
 * @param refStr - reference string
 */
function cmpStr(str, refStr) {

    //return str == refStr;
    var len = refStr.length;

    if (len !== str.length) {
        return false;
    }

    for (var i = 0; i < len; i++) {
        var code = str.charCodeAt(i);
        var refCode = refStr.charCodeAt(i);

        if (code >= 65 && code <= 90) {
            code = code | 32;
        }

        if (code !== refCode) {
            return false;
        }
    }

    return true;
}

/**
 * Case sensitive compare strings
 * @param str - input string
 * @param refStr - reference string
 */
function scmpStr(str, refStr) {
    //return str === refStr;
    var len = refStr.length;

    if (len !== str.length) {
        return false;
    }

    for (var i = 0; i < len; i++) {

        if (str.charCodeAt(i) !== refStr.charCodeAt(i)) {
            return false;
        }
    }

    return true;
}

/**
 * Export helpers
 */
exports.formatInt = formatInt;
exports.formatValue = formatValue;
exports.remRegexp = remRegexp;
exports.getUnit = getUnit;
exports.isHas = isHas;
exports.extend = extend;
exports.toCamelCase = toCamelCase;
exports.toKebabCase = toKebabCase;
exports.hasNumber = hasNumber;
exports.safeUint8Array = safeUint8Array;
exports.cmpStr = cmpStr;
exports.scmpStr = scmpStr;
exports.UNIT = UNIT;
exports.unitName = unitName;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkhlbHBlcnMuZXM2Il0sIm5hbWVzIjpbImRvdFBvcyIsInZhbHVlIiwibGVuIiwibGVuZ3RoIiwiY2hhckNvZGVBdCIsImZvcm1hdFZhbHVlIiwidG9GaXhlZCIsInBvcyIsImNvZGUiLCJyZXQiLCJzYWZlVWludDhBcnJheSIsImoiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJhcHBseSIsImZvcm1hdEludCIsIlVOSVQiLCJQWCIsIkVNIiwiUkVNIiwiVlciLCJWSCIsIlBFUkNFTlQiLCJFWCIsIlBUIiwiSU4iLCJ1bml0TmFtZSIsImdldFVuaXQiLCJjb2RlMSIsImNvZGUyIiwiY29kZTMiLCJyZW1SZWdleHAiLCJpc0hhcyIsInN0cmluZyIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsImV4dGVuZCIsIm9iamVjdDEiLCJvYmplY3QyIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJzY21wU3RyIiwiVWludDhBcnJheSIsIkFycmF5IiwidG9DYW1lbENhc2UiLCJidWZmZXIiLCJwcmV2IiwiZmlyc3RXYXMiLCJjb3VudCIsImkiLCJ0b0tlYmFiQ2FzZSIsImhhc051bWJlciIsImNtcFN0ciIsInN0ciIsInJlZlN0ciIsInJlZkNvZGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7Ozs7OztBQVdBLFNBQVNBLE1BQVQsQ0FBZ0JDLEtBQWhCLEVBQXVCO0FBQ25CLFFBQUlDLE1BQU1ELE1BQU1FLE1BQWhCO0FBQ0EsT0FBRztBQUNDRDtBQUNBLFlBQUlELE1BQU1HLFVBQU4sQ0FBaUJGLEdBQWpCLE1BQTBCLEVBQTlCLEVBQWtDO0FBQzlCLG1CQUFPQSxHQUFQO0FBQ0g7QUFDSixLQUxELFFBS1NBLE9BQU8sQ0FMaEI7QUFNQSxXQUFPLENBQUMsQ0FBUjtBQUNIOztBQUdEOzs7O0FBSUEsU0FBU0csV0FBVCxDQUFxQkosS0FBckIsRUFBNEI7QUFDeEI7QUFDQUEsWUFBUUEsTUFBTUssT0FBTixDQUFjLENBQWQsQ0FBUjtBQUNBLFFBQUlDLE1BQU1QLE9BQU9DLEtBQVAsQ0FBVjtBQUNBLFFBQUlNLE1BQU0sQ0FBQyxDQUFYLEVBQWM7QUFDVixZQUFJTCxNQUFNRCxNQUFNRSxNQUFoQjtBQUNBLFlBQUlLLE9BQU8sQ0FBWDtBQUNBLFdBQUc7QUFDQ047QUFDQU0sbUJBQU9QLE1BQU1HLFVBQU4sQ0FBaUJGLEdBQWpCLENBQVA7QUFDSCxTQUhELFFBR1VNLFNBQVMsRUFBVCxJQUFlRCxNQUFNTCxHQUF0QixJQUErQk0sU0FBUyxFQUFULElBQWVELFFBQVFMLEdBSC9EOztBQUtBLFlBQUtBLE1BQU0sQ0FBUCxLQUFjRCxNQUFNRSxNQUF4QixFQUFnQztBQUM1QixtQkFBT0YsS0FBUDtBQUNIOztBQUVELFlBQUlRLE1BQU0sSUFBSUMsY0FBSixDQUFtQlIsTUFBTSxDQUF6QixDQUFWO0FBQ0EsYUFBSyxJQUFJUyxJQUFJLENBQWIsRUFBZ0JBLEtBQUtULEdBQXJCLEVBQTBCUyxHQUExQixFQUErQjtBQUMzQkYsZ0JBQUlFLENBQUosSUFBU1YsTUFBTUcsVUFBTixDQUFpQk8sQ0FBakIsQ0FBVDtBQUNIO0FBQ0QsZUFBT0MsT0FBT0MsWUFBUCxDQUFvQkMsS0FBcEIsQ0FBMEIsSUFBMUIsRUFBZ0NMLEdBQWhDLENBQVA7QUFDSDtBQUNELFdBQU9SLEtBQVA7QUFDSDs7QUFHRDs7OztBQUlBLFNBQVNjLFNBQVQsQ0FBbUJkLEtBQW5CLEVBQTBCO0FBQ3RCLFdBQU9BLE1BQU1LLE9BQU4sQ0FBYyxDQUFkLENBQVA7QUFDSDs7QUFFRDs7O0FBR0EsSUFBTVUsT0FBTztBQUNUQyxRQUFJLENBREs7QUFFVEMsUUFBSSxDQUZLO0FBR1RDLFNBQUssQ0FISTtBQUlUQyxRQUFJLENBSks7QUFLVEMsUUFBSSxDQUxLO0FBTVRDLGFBQVMsQ0FOQTtBQU9UQyxRQUFJLENBUEs7QUFRVEMsUUFBSSxDQVJLO0FBU1RDLFFBQUk7QUFUSyxDQUFiOztBQVlBLElBQU1DLFdBQVcsQ0FBQyxFQUFELEVBQUssSUFBTCxFQUFXLElBQVgsRUFBaUIsS0FBakIsRUFBd0IsSUFBeEIsRUFBOEIsSUFBOUIsRUFBb0MsR0FBcEMsRUFBeUMsSUFBekMsRUFBK0MsSUFBL0MsRUFBcUQsSUFBckQsQ0FBakI7O0FBR0E7Ozs7QUFJQSxTQUFTQyxPQUFULENBQWlCMUIsS0FBakIsRUFBd0I7QUFDcEIsUUFBSUMsTUFBTUQsTUFBTUUsTUFBaEI7QUFDQSxRQUFJeUIsUUFBUTNCLE1BQU1HLFVBQU4sQ0FBaUJGLE1BQU0sQ0FBdkIsQ0FBWjtBQUNBLFFBQUkyQixRQUFRNUIsTUFBTUcsVUFBTixDQUFpQkYsTUFBTSxDQUF2QixDQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBSTBCLFVBQVUsRUFBZCxFQUFrQjtBQUNkLGVBQU9aLEtBQUtNLE9BQVo7QUFDSCxLQUZELE1BRU8sSUFBSU8sVUFBVSxFQUFWLElBQWdCQSxVQUFVLEdBQTlCLEVBQW1DO0FBQ3RDLFlBQUlELFVBQVUsRUFBVixJQUFnQkEsVUFBVSxHQUE5QixFQUFtQztBQUMvQixtQkFBT1osS0FBS0MsRUFBWjtBQUNILFNBRkQsTUFFTyxJQUFJVyxVQUFVLEVBQVYsSUFBZ0JBLFVBQVUsR0FBOUIsRUFBbUM7QUFDdEMsbUJBQU9aLEtBQUtRLEVBQVo7QUFDSDtBQUNKLEtBTk0sTUFNQSxJQUFJSyxVQUFVLEVBQVYsSUFBZ0JBLFVBQVUsR0FBOUIsRUFBbUM7QUFDdEMsWUFBSUQsVUFBVSxFQUFWLElBQWdCQSxVQUFVLEdBQTlCLEVBQW1DO0FBQy9CLG1CQUFPWixLQUFLSSxFQUFaO0FBQ0gsU0FGRCxNQUVPLElBQUlRLFVBQVUsRUFBVixJQUFnQkEsVUFBVSxHQUE5QixFQUFtQztBQUN0QyxtQkFBT1osS0FBS0ssRUFBWjtBQUNIO0FBQ0osS0FOTSxNQU1BLElBQUksQ0FBQ08sVUFBVSxFQUFWLElBQWdCQSxVQUFVLEdBQTNCLE1BQW9DQyxVQUFVLEVBQVYsSUFBZ0JBLFVBQVUsR0FBOUQsQ0FBSixFQUF3RTtBQUMzRSxZQUFJQyxRQUFRN0IsTUFBTUcsVUFBTixDQUFpQkYsTUFBTSxDQUF2QixDQUFaO0FBQ0EsWUFBSzRCLFVBQVUsRUFBVixJQUFnQkEsVUFBVSxHQUEvQixFQUFxQztBQUNqQyxtQkFBT2QsS0FBS0csR0FBWjtBQUNIO0FBQ0QsZUFBT0gsS0FBS0UsRUFBWjtBQUNILEtBTk0sTUFNQSxJQUFJLENBQUNVLFVBQVUsRUFBVixJQUFnQkEsVUFBVSxHQUEzQixNQUFvQ0MsVUFBVSxFQUFWLElBQWdCQSxVQUFVLEdBQTlELENBQUosRUFBd0U7QUFDM0UsZUFBT2IsS0FBS1MsRUFBWjtBQUNIOztBQUVELFdBQU8sQ0FBUDtBQUNIOztBQUdEOzs7QUFHQSxJQUFNTSxZQUFZLGVBQWxCOztBQUVBOzs7Ozs7QUFNQSxTQUFTQyxLQUFULENBQWUvQixLQUFmLEVBQXNCZ0MsTUFBdEIsRUFBOEI7QUFDMUIsV0FBT2hDLE1BQU1pQyxXQUFOLEdBQW9CQyxPQUFwQixDQUE0QkYsTUFBNUIsSUFBc0MsQ0FBQyxDQUE5QztBQUNIOztBQUdEOzs7Ozs7O0FBT0EsU0FBU0csTUFBVCxDQUFnQkMsT0FBaEIsRUFBeUJDLE9BQXpCLEVBQThDO0FBQUEsUUFBWjdCLEdBQVksdUVBQU4sSUFBTTs7O0FBRTFDLFNBQUssSUFBSThCLEdBQVQsSUFBZ0JELE9BQWhCLEVBQXlCO0FBQ3JCLFlBQUdBLFFBQVFFLGNBQVIsQ0FBdUJELEdBQXZCLENBQUgsRUFBK0I7QUFDM0JGLG9CQUFRRSxHQUFSLElBQWVELFFBQVFDLEdBQVIsQ0FBZjtBQUNIO0FBQ0o7QUFDRCxRQUFHOUIsR0FBSCxFQUFRO0FBQ0osZUFBTzRCLE9BQVA7QUFDSDtBQUNKOztBQUVELElBQU0zQixpQkFBaUIrQixlQUFlQyxVQUFmLHlDQUFlQSxVQUFmLEdBQTJCLFdBQTNCLElBQTBDQyxLQUExQyxHQUFrREQsVUFBekU7O0FBR0E7Ozs7QUFJQSxTQUFTRSxXQUFULENBQXFCM0MsS0FBckIsRUFBNEI7O0FBRXhCLFFBQUlDLE1BQU1ELE1BQU1FLE1BQWhCO0FBQ0EsUUFBSTBDLFNBQVMsSUFBSW5DLGNBQUosQ0FBbUJSLEdBQW5CLENBQWI7O0FBRUE7QUFDQTtBQUNBOztBQUVBLFFBQUk0QyxPQUFPN0MsTUFBTUcsVUFBTixDQUFpQixDQUFqQixDQUFYLENBVHdCLENBU1E7QUFDaEMsUUFBSTJDLFdBQVcsS0FBZixDQVZ3QixDQVVGO0FBQ3RCLFFBQUlDLFFBQVEsQ0FBWjtBQUNBLFNBQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJL0MsR0FBcEIsRUFBeUIrQyxHQUF6QixFQUE4Qjs7QUFFMUIsWUFBSXpDLE9BQU9QLE1BQU1HLFVBQU4sQ0FBaUI2QyxDQUFqQixDQUFYOztBQUVBO0FBQ0EsWUFBR3pDLE9BQU8sRUFBUCxJQUFhQSxPQUFPLEVBQXZCLEVBQTJCO0FBQ3ZCO0FBQ0FxQyxtQkFBT0csS0FBUCxJQUFnQnhDLElBQWhCO0FBQ0F3QztBQUVILFNBTEQsTUFLTyxJQUFJeEMsT0FBTyxFQUFQLElBQWFBLE9BQU8sR0FBeEIsRUFBNkI7QUFBRTs7QUFFbEM7QUFDQSxnQkFBSXVDLFlBQVksRUFBR0QsT0FBTyxFQUFQLElBQWFBLE9BQU8sRUFBckIsSUFBNkJBLE9BQU8sRUFBUCxJQUFhQSxPQUFPLEdBQWpELElBQTBEQSxPQUFPLEVBQVAsSUFBYUEsT0FBTyxFQUFoRixDQUFoQixFQUFzRztBQUNsR3RDLHVCQUFPQSxPQUFRLElBQUksQ0FBSixHQUFRLENBQVIsR0FBWSxDQUFaLEdBQWdCLEVBQWhCLEdBQXFCLEVBQXJCLEdBQTBCLEdBQXpDLENBRGtHLENBQ25EO0FBQ2xEOztBQUVEcUMsbUJBQU9HLEtBQVAsSUFBZ0J4QyxJQUFoQjtBQUNBd0M7O0FBRUEsZ0JBQUksQ0FBQ0QsUUFBTCxFQUFlO0FBQ1hBLDJCQUFXLElBQVg7QUFDSDtBQUVKLFNBZE0sTUFjQSxJQUFJdkMsT0FBTyxFQUFQLElBQWFBLE9BQU8sRUFBeEIsRUFBNEI7QUFBRTs7QUFFakM7QUFDQSxnQkFBS3NDLE9BQU8sRUFBUCxJQUFhQSxPQUFPLEVBQXJCLElBQTZCQSxPQUFPLEVBQVAsSUFBYUEsT0FBTyxHQUFqRCxJQUEwREEsT0FBTyxFQUFQLElBQWFBLE9BQU8sRUFBbEYsRUFBc0Y7QUFDbEZ0Qyx1QkFBT0EsT0FBTyxFQUFkLENBRGtGLENBQ2hFO0FBQ3JCOztBQUVEcUMsbUJBQU9HLEtBQVAsSUFBZ0J4QyxJQUFoQjtBQUNBd0M7O0FBRUEsZ0JBQUksQ0FBQ0QsUUFBTCxFQUFlO0FBQ1hBLDJCQUFXLElBQVg7QUFDSDtBQUVKOztBQUVERCxlQUFPdEMsSUFBUDtBQUNIO0FBQ0QsUUFBSUMsTUFBTSxJQUFJQyxjQUFKLENBQW1Cc0MsS0FBbkIsQ0FBVjtBQUNBLFNBQUssSUFBSXJDLElBQUksQ0FBYixFQUFnQkEsSUFBSXFDLEtBQXBCLEVBQTJCckMsR0FBM0IsRUFBZ0M7QUFDNUJGLFlBQUlFLENBQUosSUFBU2tDLE9BQU9sQyxDQUFQLENBQVQ7QUFDSDtBQUNELFdBQU9DLE9BQU9DLFlBQVAsQ0FBb0JDLEtBQXBCLENBQTBCLElBQTFCLEVBQWdDTCxHQUFoQyxDQUFQO0FBQ0g7O0FBR0Q7Ozs7QUFJQSxTQUFTeUMsV0FBVCxDQUFxQmpELEtBQXJCLEVBQTRCO0FBQ3hCLFFBQUlDLE1BQU1ELE1BQU1FLE1BQWhCO0FBQ0EsUUFBSTZDLFFBQVEsQ0FBWjtBQUNBLFNBQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJL0MsR0FBcEIsRUFBeUIrQyxHQUF6QixFQUE4QjtBQUMxQixZQUFJekMsT0FBT1AsTUFBTUcsVUFBTixDQUFpQjZDLENBQWpCLENBQVg7QUFDQSxZQUFJekMsUUFBUSxFQUFSLElBQWNBLFFBQVEsRUFBMUIsRUFBOEI7QUFDMUJ3QztBQUNIO0FBQ0o7QUFDRCxRQUFJSCxTQUFTLElBQUluQyxjQUFKLENBQW1CUixNQUFNOEMsS0FBekIsQ0FBYjtBQUNBLFFBQUl6QyxNQUFNLENBQVY7QUFDQSxTQUFLLElBQUkwQyxLQUFJLENBQWIsRUFBZ0JBLEtBQUkvQyxHQUFwQixFQUF5QitDLElBQXpCLEVBQThCO0FBQzFCLFlBQUl6QyxRQUFPUCxNQUFNRyxVQUFOLENBQWlCNkMsRUFBakIsQ0FBWDtBQUNBLFlBQUl6QyxTQUFRLEVBQVIsSUFBY0EsU0FBUSxFQUExQixFQUE4QjtBQUMxQnFDLG1CQUFPdEMsR0FBUCxJQUFjLEVBQWQ7QUFDQXNDLG1CQUFPdEMsTUFBTSxDQUFiLElBQWtCQyxRQUFPLEVBQXpCO0FBQ0FELG1CQUFPLENBQVA7QUFDSCxTQUpELE1BSU87QUFDSHNDLG1CQUFPdEMsR0FBUCxJQUFjQyxLQUFkO0FBQ0FEO0FBQ0g7QUFDSjtBQUNELFdBQU9LLE9BQU9DLFlBQVAsQ0FBb0JDLEtBQXBCLENBQTBCLElBQTFCLEVBQWdDK0IsTUFBaEMsQ0FBUDtBQUNIOztBQUdEOzs7O0FBSUEsU0FBU00sU0FBVCxDQUFtQmxELEtBQW5CLEVBQTBCO0FBQ3RCLFFBQUlDLE1BQU1ELE1BQU1FLE1BQWhCO0FBQ0EsU0FBSyxJQUFJOEMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJL0MsR0FBcEIsRUFBeUIrQyxHQUF6QixFQUE4QjtBQUMxQixZQUFJekMsT0FBT1AsTUFBTUcsVUFBTixDQUFpQjZDLENBQWpCLENBQVg7QUFDQSxZQUFJekMsUUFBUSxFQUFSLElBQWNBLFFBQVEsRUFBMUIsRUFBOEI7QUFDMUIsbUJBQU8sSUFBUDtBQUNIO0FBQ0o7QUFDRCxXQUFPLEtBQVA7QUFDSDs7QUFHRDs7Ozs7QUFLQSxTQUFTNEMsTUFBVCxDQUFnQkMsR0FBaEIsRUFBcUJDLE1BQXJCLEVBQTZCOztBQUV6QjtBQUNBLFFBQUlwRCxNQUFNb0QsT0FBT25ELE1BQWpCOztBQUVBLFFBQUlELFFBQVFtRCxJQUFJbEQsTUFBaEIsRUFBd0I7QUFDcEIsZUFBTyxLQUFQO0FBQ0g7O0FBRUQsU0FBSyxJQUFJOEMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJL0MsR0FBcEIsRUFBeUIrQyxHQUF6QixFQUE4QjtBQUMxQixZQUFJekMsT0FBTzZDLElBQUlqRCxVQUFKLENBQWU2QyxDQUFmLENBQVg7QUFDQSxZQUFJTSxVQUFVRCxPQUFPbEQsVUFBUCxDQUFrQjZDLENBQWxCLENBQWQ7O0FBRUEsWUFBSXpDLFFBQVEsRUFBUixJQUFjQSxRQUFRLEVBQTFCLEVBQThCO0FBQzFCQSxtQkFBT0EsT0FBTyxFQUFkO0FBQ0g7O0FBRUQsWUFBSUEsU0FBUytDLE9BQWIsRUFBc0I7QUFDbEIsbUJBQU8sS0FBUDtBQUNIO0FBQ0o7O0FBRUQsV0FBTyxJQUFQO0FBQ0g7O0FBR0Q7Ozs7O0FBS0EsU0FBU2QsT0FBVCxDQUFpQlksR0FBakIsRUFBc0JDLE1BQXRCLEVBQThCO0FBQzFCO0FBQ0EsUUFBSXBELE1BQU1vRCxPQUFPbkQsTUFBakI7O0FBRUEsUUFBSUQsUUFBUW1ELElBQUlsRCxNQUFoQixFQUF3QjtBQUNwQixlQUFPLEtBQVA7QUFDSDs7QUFFRCxTQUFLLElBQUk4QyxJQUFJLENBQWIsRUFBZ0JBLElBQUkvQyxHQUFwQixFQUF5QitDLEdBQXpCLEVBQThCOztBQUUxQixZQUFJSSxJQUFJakQsVUFBSixDQUFlNkMsQ0FBZixNQUFzQkssT0FBT2xELFVBQVAsQ0FBa0I2QyxDQUFsQixDQUExQixFQUFnRDtBQUM1QyxtQkFBTyxLQUFQO0FBQ0g7QUFDSjs7QUFFRCxXQUFPLElBQVA7QUFDSDs7QUFHRDs7O1FBSUlsQyxTLEdBQUFBLFM7UUFDQVYsVyxHQUFBQSxXO1FBQ0EwQixTLEdBQUFBLFM7UUFDQUosTyxHQUFBQSxPO1FBQ0FLLEssR0FBQUEsSztRQUNBSSxNLEdBQUFBLE07UUFDQVEsVyxHQUFBQSxXO1FBQ0FNLFcsR0FBQUEsVztRQUNBQyxTLEdBQUFBLFM7UUFDQXpDLGMsR0FBQUEsYztRQUNBMEMsTSxHQUFBQSxNO1FBQ0FYLE8sR0FBQUEsTztRQUNBekIsSSxHQUFBQSxJO1FBQ0FVLFEsR0FBQUEsUSIsImZpbGUiOiJIZWxwZXJzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBtb2R1bGUgSGVscGVyXHJcbiAqIFxyXG4gKiBAZGVzY3JpcHRpb24gQ29uc3RhbnRzIGFuZCBIZWxwIGZ1bmN0aW9ucy5cclxuICogXHJcbiAqIEB2ZXJzaW9uIDEuMFxyXG4gKiBAYXV0aG9yIEdyaWdvcnkgVmFzaWx5ZXYgPHBvc3Rjc3MuaGFtc3RlckBnbWFpbC5jb20+IGh0dHBzOi8vZ2l0aHViLmNvbS9oMHRjMGQzXHJcbiAqIEBjb3B5cmlnaHQgQ29weXJpZ2h0IChjKSAyMDE3LCBHcmlnb3J5IFZhc2lseWV2XHJcbiAqIEBsaWNlbnNlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCwgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wIFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIGRvdFBvcyh2YWx1ZSkge1xyXG4gICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgIGRvIHtcclxuICAgICAgICBsZW4tLTtcclxuICAgICAgICBpZiAodmFsdWUuY2hhckNvZGVBdChsZW4pID09PSA0Nikge1xyXG4gICAgICAgICAgICByZXR1cm4gbGVuO1xyXG4gICAgICAgIH1cclxuICAgIH0gd2hpbGUgKGxlbiA+PSAwKTtcclxuICAgIHJldHVybiAtMTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBGYXN0IEZvcm1hdCBGbG9hdCBWYWx1ZXMuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIGlucHV0IHZhbHVlLlxyXG4gKi9cclxuZnVuY3Rpb24gZm9ybWF0VmFsdWUodmFsdWUpIHtcclxuICAgIC8vIC4gLSA0NiAwIC0gNDhcclxuICAgIHZhbHVlID0gdmFsdWUudG9GaXhlZCg0KTtcclxuICAgIGxldCBwb3MgPSBkb3RQb3ModmFsdWUpO1xyXG4gICAgaWYgKHBvcyA+IC0xKSB7XHJcbiAgICAgICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgICAgICBsZXQgY29kZSA9IDA7XHJcbiAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICBsZW4tLTtcclxuICAgICAgICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQobGVuKTtcclxuICAgICAgICB9IHdoaWxlICgoY29kZSA9PT0gNDggJiYgcG9zIDwgbGVuKSB8fCAoY29kZSA9PT0gNDYgJiYgcG9zID09PSBsZW4pKTtcclxuXHJcbiAgICAgICAgaWYgKChsZW4gKyAxKSA9PT0gdmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCByZXQgPSBuZXcgc2FmZVVpbnQ4QXJyYXkobGVuICsgMSk7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gbGVuOyBqKyspIHtcclxuICAgICAgICAgICAgcmV0W2pdID0gdmFsdWUuY2hhckNvZGVBdChqKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgcmV0KTtcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBGb3JtYXQgTnVtYmVyIHRvIEludC5cclxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIC0gaW5wdXQgdmFsdWUuXHJcbiAqL1xyXG5mdW5jdGlvbiBmb3JtYXRJbnQodmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZS50b0ZpeGVkKDApO1xyXG59XHJcblxyXG4vKipcclxuICogVW5pdCBMaXN0XHJcbiAqL1xyXG5jb25zdCBVTklUID0ge1xyXG4gICAgUFg6IDEsXHJcbiAgICBFTTogMixcclxuICAgIFJFTTogMyxcclxuICAgIFZXOiA0LFxyXG4gICAgVkg6IDUsXHJcbiAgICBQRVJDRU5UOiA2LFxyXG4gICAgRVg6IDcsXHJcbiAgICBQVDogOCxcclxuICAgIElOOiA5XHJcbn07XHJcblxyXG5jb25zdCB1bml0TmFtZSA9IFtcIlwiLCBcInB4XCIsIFwiZW1cIiwgXCJyZW1cIiwgXCJ2d1wiLCBcInZoXCIsIFwiJVwiLCBcImV4XCIsIFwicHRcIiwgXCJpblwiXTtcclxuXHJcblxyXG4vKipcclxuICogUmV0dXJuIFVuaXQgdG8gdmFsdWUuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIGlucHV0IHZhbHVlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0VW5pdCh2YWx1ZSkge1xyXG4gICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgIGxldCBjb2RlMSA9IHZhbHVlLmNoYXJDb2RlQXQobGVuIC0gMSk7XHJcbiAgICBsZXQgY29kZTIgPSB2YWx1ZS5jaGFyQ29kZUF0KGxlbiAtIDIpO1xyXG4gICAgLy8gcCA4MCAxMTJcclxuICAgIC8vIHggODggMTIwXHJcbiAgICAvLyB0IDg0IDExNlxyXG4gICAgLy8gZSA2OSAxMDFcclxuICAgIC8vIG0gNzcgMTA5XHJcbiAgICAvLyByIDgyIDExNFxyXG4gICAgLy8gdiA4NiAxMThcclxuICAgIC8vIHcgODcgMTE5XHJcbiAgICAvLyBoIDcyIDEwNFxyXG4gICAgLy8gaSA3MyAxMDVcclxuICAgIC8vIG4gNzggMTEwXHJcbiAgICAvLyAlIDM3XHJcbiAgICBpZiAoY29kZTEgPT09IDM3KSB7XHJcbiAgICAgICAgcmV0dXJuIFVOSVQuUEVSQ0VOVDtcclxuICAgIH0gZWxzZSBpZiAoY29kZTIgPT09IDgwIHx8IGNvZGUyID09PSAxMTIpIHtcclxuICAgICAgICBpZiAoY29kZTEgPT09IDg4IHx8IGNvZGUxID09PSAxMjApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFVOSVQuUFg7XHJcbiAgICAgICAgfSBlbHNlIGlmIChjb2RlMSA9PT0gODQgfHwgY29kZTEgPT09IDExNikge1xyXG4gICAgICAgICAgICByZXR1cm4gVU5JVC5QVDtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGNvZGUyID09PSA4NiB8fCBjb2RlMiA9PT0gMTE4KSB7XHJcbiAgICAgICAgaWYgKGNvZGUxID09PSA4NyB8fCBjb2RlMSA9PT0gMTE5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBVTklULlZXO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY29kZTEgPT09IDcyIHx8IGNvZGUxID09PSAxMDQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFVOSVQuVkg7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIGlmICgoY29kZTEgPT09IDc3IHx8IGNvZGUxID09PSAxMDkpICYmIChjb2RlMiA9PT0gNjkgfHwgY29kZTIgPT09IDEwMSkpIHtcclxuICAgICAgICBsZXQgY29kZTMgPSB2YWx1ZS5jaGFyQ29kZUF0KGxlbiAtIDMpO1xyXG4gICAgICAgIGlmICgoY29kZTMgPT09IDgyIHx8IGNvZGUzID09PSAxMTQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBVTklULlJFTTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFVOSVQuRU07XHJcbiAgICB9IGVsc2UgaWYgKChjb2RlMSA9PT0gNzggfHwgY29kZTEgPT09IDExMCkgJiYgKGNvZGUyID09PSA3MyB8fCBjb2RlMiA9PT0gMTA1KSkge1xyXG4gICAgICAgIHJldHVybiBVTklULklOO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAwO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFJlZ2V4cCBmb3IgcmVtIHZhbHVlLlxyXG4gKi9cclxuY29uc3QgcmVtUmVnZXhwID0gLyhbMC05Ll0rKXJlbS9pO1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIHZhbHVlIGNvbnRhaW5zIHN0cmluZztcclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gaW5wdXQgdmFsdWUuXHJcbiAqIEBwYXJhbSBzdHJpbmdcclxuICovXHJcblxyXG5mdW5jdGlvbiBpc0hhcyh2YWx1ZSwgc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKHN0cmluZykgPiAtMTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBDb3B5IFZhbHVlcyBmcm9tIG9iamVjdCAyIHRvIG9iamVjdCAxLlxyXG4gKiBAcGFyYW0gb2JqZWN0MSBcclxuICogQHBhcmFtIG9iamVjdDJcclxuICogQHBhcmFtIHJldCAtIHJldHVybiBvYmplY3QxIHRydWUgb3IgZmFsc2VcclxuICogQHJldHVybiBvYmplY3QxXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRlbmQob2JqZWN0MSwgb2JqZWN0MiwgcmV0ID0gdHJ1ZSkge1xyXG5cclxuICAgIGZvciAobGV0IGtleSBpbiBvYmplY3QyKSB7XHJcbiAgICAgICAgaWYob2JqZWN0Mi5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcclxuICAgICAgICAgICAgb2JqZWN0MVtrZXldID0gb2JqZWN0MltrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmKHJldCkge1xyXG4gICAgICAgIHJldHVybiBvYmplY3QxO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBzYWZlVWludDhBcnJheSA9IHNjbXBTdHIodHlwZW9mIFVpbnQ4QXJyYXksIFwidW5kZWZpbmVkXCIpID8gQXJyYXkgOiBVaW50OEFycmF5O1xyXG5cclxuXHJcbi8qKlxyXG4gKiBUbyBDYW1lbCBDYXNlIHN0cmluZy5cclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlICAtIGlucHV0IHN0cmluZy5cclxuICovXHJcbmZ1bmN0aW9uIHRvQ2FtZWxDYXNlKHZhbHVlKSB7XHJcblxyXG4gICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgIGxldCBidWZmZXIgPSBuZXcgc2FmZVVpbnQ4QXJyYXkobGVuKTtcclxuXHJcbiAgICAvLyBDb2RlOiA0OC01NyBDaGFyczogMC05XHJcbiAgICAvLyBDb2RlOiA2NS05MCBDaGFyczogQS1aIFxyXG4gICAgLy8gQ29kZTogOTctMTIyIENoYXJzOiBhLXpcclxuXHJcbiAgICBsZXQgcHJldiA9IHZhbHVlLmNoYXJDb2RlQXQoMCk7IC8vIHByZXZpb3VzIGNoYXJcclxuICAgIGxldCBmaXJzdFdhcyA9IGZhbHNlOyAvL2lzIGZpcnN0IGxldHRlciB3YXNcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcblxyXG4gICAgICAgIGxldCBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChpKTtcclxuXHJcbiAgICAgICAgLy8gSXQncyBOdW1iZXJcclxuICAgICAgICBpZihjb2RlID4gNDcgJiYgY29kZSA8IDU4KSB7XHJcbiAgICAgICAgICAgIC8vIEFkZCBOdW1iZXJcclxuICAgICAgICAgICAgYnVmZmVyW2NvdW50XSA9IGNvZGU7XHJcbiAgICAgICAgICAgIGNvdW50Kys7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoY29kZSA+IDk2ICYmIGNvZGUgPCAxMjMpIHsgLy8gSXQncyBsb3dlciBjYXNlIGxldHRlclxyXG5cclxuICAgICAgICAgICAgLy9JZiBwcmV2aW91cyBjaGFyIGlzJ3QgbGV0dGVyIG9yIG51bWJlcixcclxuICAgICAgICAgICAgaWYgKGZpcnN0V2FzICYmICEoKHByZXYgPiA0NyAmJiBwcmV2IDwgNTgpIHx8IChwcmV2ID4gOTYgJiYgcHJldiA8IDEyMykgfHwgKHByZXYgPiA2NCAmJiBwcmV2IDwgOTEpKSkge1xyXG4gICAgICAgICAgICAgICAgY29kZSA9IGNvZGUgJiAoMSArIDIgKyA0ICsgOCArIDE2ICsgNjQgKyAxMjgpOyAvLyB0b1VwcGVyQ2FzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBidWZmZXJbY291bnRdID0gY29kZTtcclxuICAgICAgICAgICAgY291bnQrKztcclxuXHJcbiAgICAgICAgICAgIGlmICghZmlyc3RXYXMpIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0V2FzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPiA2NCAmJiBjb2RlIDwgOTEpIHsgLy8gSXQncyB1cHBlciBjYXNlIGxldHRlclxyXG5cclxuICAgICAgICAgICAgLy8gSWYgcHJldmlvdXMgY2hhciBpcyBsZXR0ZXIgb3IgbnVtYmVyLFxyXG4gICAgICAgICAgICBpZiAoKHByZXYgPiA0NyAmJiBwcmV2IDwgNTgpIHx8IChwcmV2ID4gOTYgJiYgcHJldiA8IDEyMykgfHwgKHByZXYgPiA2NCAmJiBwcmV2IDwgOTEpKXtcclxuICAgICAgICAgICAgICAgIGNvZGUgPSBjb2RlIHwgMzI7IC8vIHRvTG93ZXJDYXNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJ1ZmZlcltjb3VudF0gPSBjb2RlO1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFmaXJzdFdhcykge1xyXG4gICAgICAgICAgICAgICAgZmlyc3RXYXMgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJldiA9IGNvZGU7XHJcbiAgICB9XHJcbiAgICBsZXQgcmV0ID0gbmV3IHNhZmVVaW50OEFycmF5KGNvdW50KTtcclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgY291bnQ7IGorKykge1xyXG4gICAgICAgIHJldFtqXSA9IGJ1ZmZlcltqXTtcclxuICAgIH1cclxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIHJldCk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogVG8gS2ViYWIgQ2FzZSBzdHJpbmcuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAgLSBpbnB1dCBzdHJpbmcuXHJcbiAqL1xyXG5mdW5jdGlvbiB0b0tlYmFiQ2FzZSh2YWx1ZSkge1xyXG4gICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjb2RlID49IDY1ICYmIGNvZGUgPD0gOTApIHtcclxuICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgYnVmZmVyID0gbmV3IHNhZmVVaW50OEFycmF5KGxlbiArIGNvdW50KTtcclxuICAgIGxldCBwb3MgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIGxldCBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoY29kZSA+PSA2NSAmJiBjb2RlIDw9IDkwKSB7XHJcbiAgICAgICAgICAgIGJ1ZmZlcltwb3NdID0gNDU7XHJcbiAgICAgICAgICAgIGJ1ZmZlcltwb3MgKyAxXSA9IGNvZGUgfCAzMjtcclxuICAgICAgICAgICAgcG9zICs9IDI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnVmZmVyW3Bvc10gPSBjb2RlO1xyXG4gICAgICAgICAgICBwb3MrKztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBidWZmZXIpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIENoZWNrIHN0cmluZyBjb250YWlucyBudW1iZXIuXHJcbiAqIEBwYXJhbSB2YWx1ZSAtIGlucHV0IHN0cmluZy5cclxuICovXHJcbmZ1bmN0aW9uIGhhc051bWJlcih2YWx1ZSkge1xyXG4gICAgbGV0IGxlbiA9IHZhbHVlLmxlbmd0aDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBsZXQgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgaWYgKGNvZGUgPj0gNDggJiYgY29kZSA8PSA1Nykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogQ29tcGFyZSBpbnB1dCBzdHJpbmcgd2l0aCByZWZlcmVuY2Ugc3RyaW5nLlxyXG4gKiBAcGFyYW0gc3RyIC0gaW5wdXQgc3RyaW5nXHJcbiAqIEBwYXJhbSByZWZTdHIgLSByZWZlcmVuY2Ugc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBjbXBTdHIoc3RyLCByZWZTdHIpIHtcclxuXHJcbiAgICAvL3JldHVybiBzdHIgPT0gcmVmU3RyO1xyXG4gICAgbGV0IGxlbiA9IHJlZlN0ci5sZW5ndGg7XHJcblxyXG4gICAgaWYgKGxlbiAhPT0gc3RyLmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGNvZGUgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBsZXQgcmVmQ29kZSA9IHJlZlN0ci5jaGFyQ29kZUF0KGkpO1xyXG5cclxuICAgICAgICBpZiAoY29kZSA+PSA2NSAmJiBjb2RlIDw9IDkwKSB7XHJcbiAgICAgICAgICAgIGNvZGUgPSBjb2RlIHwgMzI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY29kZSAhPT0gcmVmQ29kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIENhc2Ugc2Vuc2l0aXZlIGNvbXBhcmUgc3RyaW5nc1xyXG4gKiBAcGFyYW0gc3RyIC0gaW5wdXQgc3RyaW5nXHJcbiAqIEBwYXJhbSByZWZTdHIgLSByZWZlcmVuY2Ugc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBzY21wU3RyKHN0ciwgcmVmU3RyKSB7XHJcbiAgICAvL3JldHVybiBzdHIgPT09IHJlZlN0cjtcclxuICAgIGxldCBsZW4gPSByZWZTdHIubGVuZ3RoO1xyXG5cclxuICAgIGlmIChsZW4gIT09IHN0ci5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG5cclxuICAgICAgICBpZiAoc3RyLmNoYXJDb2RlQXQoaSkgIT09IHJlZlN0ci5jaGFyQ29kZUF0KGkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogRXhwb3J0IGhlbHBlcnNcclxuICovXHJcbmV4cG9ydCB7XHJcbiAgICBmb3JtYXRJbnQsXHJcbiAgICBmb3JtYXRWYWx1ZSxcclxuICAgIHJlbVJlZ2V4cCxcclxuICAgIGdldFVuaXQsXHJcbiAgICBpc0hhcyxcclxuICAgIGV4dGVuZCxcclxuICAgIHRvQ2FtZWxDYXNlLFxyXG4gICAgdG9LZWJhYkNhc2UsXHJcbiAgICBoYXNOdW1iZXIsXHJcbiAgICBzYWZlVWludDhBcnJheSxcclxuICAgIGNtcFN0cixcclxuICAgIHNjbXBTdHIsXHJcbiAgICBVTklULFxyXG4gICAgdW5pdE5hbWVcclxufTsiXX0=
